Описание проекта.

Проект мини версия интернет биллинга.
Основная задача хранить данные клиентов, список подключений и технические данные. История начислений и оплат. Автоматически считает баланс клиента.
Обеспечивать связанность данных.


Всю базу можно условно разделить на 4 части:
1) информация по клиентам (фио, паспортные данные, адрес проживания и т д). Таблицы: users и profiles
2) техническую информацию (информация по подключению из тарифного плана, коммутатора, порта, адреса подключения и т д). Таблицы: connections и connections_tech
3) финансовую по начислениям и оплатам. Таблицы: payment_history, accruals
4) справочники тарифных планов, адресов, коммутаторов, типов услуг. Таблицы: address, service_type, tariff_plan, techbase


почти все поля связаны внешними ключами, имеют признак уникальных значений или первичного ключа. Из-за этого в индексе не вижу особо смысла, создал на пару логин/пароль, но не уверен, что он вообще имеет смысл.

в базе созданы триггеры:
1) проверка уникального значения паспорта (пара серия + номер).
2) изменение баланса при создании начислений или совершении оплаты.

процедура для создания начислений за выбранный период.
при вызове процедуры accruals_generator и передачи ей даты создаются начисления по всем существующим подключениям, т.е. accruals_generator('2021-01-01')

создано 3 представления
1) client - содержит полную информацию по клиенту
2) client_connections - информация по подключениям (без детальной технической информации).
3) total_connection_info - информация по подключению с тех информацией.

запрос на создание списка доступных для подключения тарифов (на основании технологии и типа услуги подключения для которого идет запрос.
запрос на список начислений
запрос на список оплат
запрос начислений + оплат в разрезе периодов, реализовано через вызов процедуры fin_info(user_id)



